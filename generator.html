<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èƒ½ç ”é™¢æ–°å¹´ç¥ç¦äºŒç»´ç ç”Ÿæˆå™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #ffd93d 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            max-width: 500px;
            width: 100%;
            text-align: center;
        }

        h1 {
            color: #d40000;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .input-group {
            margin-bottom: 30px;
        }

        label {
            display: block;
            text-align: left;
            margin-bottom: 10px;
            color: #333;
            font-weight: bold;
        }

        input[type="text"] {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border: 2px solid #ffd93d;
            border-radius: 10px;
            outline: none;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            border-color: #ff6b6b;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        button {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .generate-btn {
            background: #ff6b6b;
            color: white;
        }

        .generate-btn:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        .download-btn {
            background: #4CAF50;
            color: white;
            display: none;
        }

        .download-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .download-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        #qrcode {
            margin: 30px auto;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
            display: inline-block;
            display: none;
        }

        .tips {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
            font-size: 14px;
            color: #856404;
        }

        .preview-link {
            background: #e8f4f8;
            border: 1px solid #4da6ff;
            border-radius: 8px;
            padding: 10px;
            margin-top: 15px;
            font-size: 12px;
            color: #0066cc;
            word-break: break-all;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŠ èƒ½ç ”é™¢æ–°å¹´ç¥ç¦äºŒç»´ç ç”Ÿæˆå™¨ ğŸŠ</h1>
        
        <div class="input-group">
            <label for="nameInput">è¯·è¾“å…¥æ¥æ”¶äººå§“åï¼š</label>
            <input type="text" id="nameInput" placeholder="ä¾‹å¦‚ï¼šå¼ ä¸»ä»»ã€æä¸»ä»»ç­‰">
        </div>

        <div class="button-group">
            <button class="generate-btn" onclick="generateQRCode()">ç”ŸæˆäºŒç»´ç </button>
            <button class="download-btn" id="downloadBtn" onclick="downloadQRCode()">ä¸‹è½½äºŒç»´ç </button>
        </div>

        <div id="qrcode"></div>

        <div class="preview-link" id="previewLink">
            <strong>é¢„è§ˆé“¾æ¥ï¼š</strong><br>
            <a href=" " target="_blank" id="previewUrl"></a >
        </div>

        <div class="tips">
            <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
            1. è¾“å…¥æ¥æ”¶äººå§“åï¼ˆå¦‚ï¼šå¼ ä¸»ä»»ï¼‰<br>
            2. ç‚¹å‡»"ç”ŸæˆäºŒç»´ç "<br>
            3. ç‚¹å‡»"ä¸‹è½½äºŒç»´ç "ä¿å­˜å›¾ç‰‡<br>
            4. å°†äºŒç»´ç å‘é€ç»™å¯¹åº”çš„äºº<br>
            5. æ‰«ç åå³å¯æŸ¥çœ‹ä¸ªæ€§åŒ–ç¥ç¦åŠ¨ç”»
        </div>
    </div>

    <script>
        let qrcodeInstance = null;

        function generateQRCode() {
            const name = document.getElementById('nameInput').value.trim();
            
            if (!name) {
                alert('è¯·è¾“å…¥å§“åï¼');
                return;
            }

            // è·å–å½“å‰é¡µé¢çš„åŸºç¡€URL
            const baseUrl = window.location.origin + window.location.pathname.replace('/generator.html', '');
            
            // ç”Ÿæˆå¸¦å‚æ•°çš„åŠ¨ç”»é¡µé¢URL
            const animationUrl = `${baseUrl}/newyear.html?name=${encodeURIComponent(name)}`;
            
            // æ¸…é™¤ä¹‹å‰çš„äºŒç»´ç 
            const qrcodeDiv = document.getElementById('qrcode');
            qrcodeDiv.innerHTML = '';
            qrcodeDiv.style.display = 'block';
            
            // ç”Ÿæˆæ–°äºŒç»´ç 
            qrcodeInstance = new QRCode(qrcodeDiv, {
                text: animationUrl,
                width: 256,
                height: 256,
                colorDark: '#d40000',
                colorLight: '#ffffff',
                correctLevel: QRCode.CorrectLevel.H
            });

            // æ˜¾ç¤ºä¸‹è½½æŒ‰é’®
            document.getElementById('downloadBtn').style.display = 'block';
            
            // æ˜¾ç¤ºé¢„è§ˆé“¾æ¥
            const previewLink = document.getElementById('previewLink');
            const previewUrl = document.getElementById('previewUrl');
            previewLink.style.display = 'block';
            previewUrl.href = animationUrl;
            previewUrl.textContent = animationUrl;
        }

        function downloadQRCode() {
            if (!qrcodeInstance) {
                alert('è¯·å…ˆç”ŸæˆäºŒç»´ç ï¼');
                return;
            }

            const canvas = document.querySelector('#qrcode canvas');
            if (canvas) {
                const url = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.download = `æ–°å¹´ç¥ç¦äºŒç»´ç _${document.getElementById('nameInput').value.trim()}.png`;
                link.href = url;
                link.click();
            } else {
                alert('äºŒç»´ç ç”Ÿæˆä¸­ï¼Œè¯·ç¨åå†è¯•ï¼');
            }
        }

        // å›è½¦é”®ç”ŸæˆäºŒç»´ç 
        document.getElementById('nameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateQRCode();
            }
        });
    </script>
</body>
</html>